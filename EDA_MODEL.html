
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Introduction &#8212; Deep Learning Exam</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'EDA_MODEL';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to our solution for the Deep Learning Exam" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Deep Learning Exam - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Deep Learning Exam - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to our solution for the Deep Learning Exam
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Introduction</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FEDA_MODEL.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/EDA_MODEL.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Introduction</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-application-problem">Understanding the Application Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-types">Data Types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source">Data Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explanatory-variables">Explanatory Variables</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-problem">Application Problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach">Approach</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#smiles-simplified-molecular-input-line-entry-system">SMILES (Simplified Molecular Input Line Entry System)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-smiles">What is SMILES?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smiles">SMILES</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#molecules">Molecules</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-in-depth-visualization-for-first-molecule">More in depth visualization for first molecule</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-first-molecule">3D First Molecule</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo">Modelo</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h1>
<p>In the realm of drug discovery, small molecule drugs interact with proteins within cells to modulate biological functions, often by inhibiting specific proteins implicated in disease processes. Traditionally, identifying candidate molecules that bind to protein targets involves synthesizing them individually and testing their interactions—a time-consuming and laborious process. Given that the FDA has approved only about 2,000 novel molecular entities, compared to an estimated 10^60 potential drug-like molecules, there is a clear need for more efficient methods to explore this vast chemical space.</p>
<p>The BELKA dataset, provided by Leash Biosciences, offers a unique opportunity to leverage machine learning to predict the binding affinities of small molecules to specific protein targets. By employing advanced ML techniques, this project aims to revolutionize the search for effective treatments hidden within the expansive chemical space, accelerating the drug discovery process and potentially uncovering new lifesaving medicines.</p>
<section id="understanding-the-application-problem">
<h2>Understanding the Application Problem<a class="headerlink" href="#understanding-the-application-problem" title="Link to this heading">#</a></h2>
<section id="data-types">
<h3>Data Types<a class="headerlink" href="#data-types" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Chemical Structures</strong>: Represented as SMILES (Simplified Molecular-Input Line-Entry System) strings, detailing the composition of small molecules at various stages:</p>
<ul class="simple">
<li><p><strong>Building Blocks</strong>: SMILES representations for the first, second, and third building blocks of the molecule.</p></li>
<li><p><strong>Full Molecule</strong>: A complete SMILES representation of the fully assembled molecule, including the building blocks and a triazine core with a DNA linker.</p></li>
</ul>
</li>
<li><p><strong>Protein Information</strong>:</p>
<ul class="simple">
<li><p><strong>Protein Target Name</strong>: Identifies which of the three protein targets (EPHX2, BRD4, ALB) the molecule is tested against.</p></li>
</ul>
</li>
<li><p><strong>Response Variable</strong>:</p>
<ul class="simple">
<li><p><strong>Binding Label (<code class="docutils literal notranslate"><span class="pre">binds</span></code>)</strong>: A binary classification (0 or 1) indicating whether the molecule binds to the protein target. This is the response variable and is only available in the training dataset.</p></li>
</ul>
</li>
</ol>
</section>
<section id="data-source">
<h3>Data Source<a class="headerlink" href="#data-source" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>BELKA Dataset</strong>: Generated by Leash Biosciences using DNA-encoded chemical library (DEL) technology, comprising approximately 133 million small molecules tested against three protein targets. The dataset includes roughly 98 million training examples per protein, with separate validation and test sets that incorporate novel building blocks not present in the training data to assess model generalizability.</p></li>
</ul>
</section>
<section id="explanatory-variables">
<h3>Explanatory Variables<a class="headerlink" href="#explanatory-variables" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Molecular SMILES</strong>: Used to predict the binding potential of the molecules.</p></li>
<li><p><strong>Building Block SMILES</strong>: Provide information on the constituent parts of the full molecule, potentially relevant for understanding binding interactions.</p></li>
<li><p><strong>Protein Target Name</strong>: Helps differentiate the context of binding predictions as each protein has unique structural and functional characteristics that influence binding.</p></li>
</ul>
</section>
</section>
<section id="application-problem">
<h2>Application Problem<a class="headerlink" href="#application-problem" title="Link to this heading">#</a></h2>
<p>The task is to build predictive models that estimate the likelihood of small molecules binding to specific protein targets. This involves understanding how chemical structures (represented by SMILES) interact with the proteins EPHX2 (sEH), BRD4, and ALB. The challenge is amplified by the highly imbalanced nature of the dataset, where only about 0.5% of molecules are classified as binders.</p>
</section>
<section id="approach">
<h2>Approach<a class="headerlink" href="#approach" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Preprocessing and Feature Engineering</strong>:</p>
<ul class="simple">
<li><p>Convert SMILES strings into numerical features using cheminformatics tools like RDKit. Techniques include generating molecular fingerprints, descriptors, or embeddings that can be fed into machine learning models.</p></li>
<li><p>Incorporate protein structural information, such as sequence data or 3D structures, which may enhance the models’ understanding of binding contexts.</p></li>
</ul>
</li>
<li><p><strong>Model Development</strong>:</p>
<ul class="simple">
<li><p>Begin with baseline models (e.g., XGBoost, random forests) to establish a performance benchmark.</p></li>
<li><p>Progress to more advanced models like neural networks, or transformer-based architectures tailored for SMILES data.</p></li>
</ul>
</li>
<li><p><strong>Handling Imbalanced Data</strong>:</p>
<ul class="simple">
<li><p>Use techniques such as oversampling, undersampling, or algorithm-specific adjustments (e.g., class weights) to address the severe class imbalance.</p></li>
<li><p>Evaluate models with metrics that are robust to imbalance, such as precision-recall AUC, F1 score, or Matthews correlation coefficient.</p></li>
</ul>
</li>
<li><p><strong>Evaluation and Validation</strong>:</p>
<ul class="simple">
<li><p>Implement stratified k-fold cross-validation to ensure that the evaluation metrics reflect the model’s ability to generalize across the imbalanced classes.</p></li>
<li><p>Test generalizability on the provided test set, which includes molecules with novel building blocks not seen in the training data, to simulate real-world conditions.</p></li>
</ul>
</li>
</ol>
<p>This project aims to contribute to the advancement of computational drug discovery by leveraging the BELKA dataset to predict small molecule binding to protein targets. By employing sophisticated machine learning models and tackling the challenges of data imbalance and generalizability, the resulting predictive models have the potential to significantly accelerate the identification of promising drug candidates, democratizing aspects of drug discovery and aiding in the development of new therapies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">duckdb</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">Draw</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">Descriptors</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">RDLogger</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">IPImage</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">&#39;:memory:&#39;</span><span class="p">)</span>

<span class="n">parquet_file_path</span> <span class="o">=</span> <span class="s1">&#39;train.parquet/train.parquet&#39;</span>

<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">1000000</span>

<span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CREATE TABLE train_sample AS SELECT * FROM read_parquet(&#39;</span><span class="si">{</span><span class="n">parquet_file_path</span><span class="si">}</span><span class="s2">&#39;) USING SAMPLE </span><span class="si">{</span><span class="n">sample_size</span><span class="si">}</span><span class="s2"> ROWS&quot;</span><span class="p">)</span>

<span class="n">df_sample</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM train_sample LIMIT 5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial Rows from the Sample Dataset:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">IOException</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">parquet_file_path</span> <span class="o">=</span> <span class="s1">&#39;train.parquet/train.parquet&#39;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">sample_size</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CREATE TABLE train_sample AS SELECT * FROM read_parquet(&#39;</span><span class="si">{</span><span class="n">parquet_file_path</span><span class="si">}</span><span class="s2">&#39;) USING SAMPLE </span><span class="si">{</span><span class="n">sample_size</span><span class="si">}</span><span class="s2"> ROWS&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">df_sample</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM train_sample LIMIT 5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial Rows from the Sample Dataset:&quot;</span><span class="p">)</span>

<span class="ne">IOException</span>: IO Error: No files found that match the pattern &quot;train.parquet/train.parquet&quot;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="smiles-simplified-molecular-input-line-entry-system">
<h1>SMILES (Simplified Molecular Input Line Entry System)<a class="headerlink" href="#smiles-simplified-molecular-input-line-entry-system" title="Link to this heading">#</a></h1>
<section id="what-is-smiles">
<h2>What is SMILES?<a class="headerlink" href="#what-is-smiles" title="Link to this heading">#</a></h2>
<p>“SMILES (Simplified Molecular Input Line Entry System) is a chemical notation that allows a user to represent a chemical structure in a way that can be used by the computer. SMILES is an easily learned and flexible notation. The SMILES notation requires that you learn a handful of rules. You do not need to worry about ambiguous representations because the software will automatically reorder your entry into a unique SMILES string when necessary.”</p>
</section>
<section id="smiles">
<h2>SMILES<a class="headerlink" href="#smiles" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>buildingblock1_smiles - The structure, in SMILES, of the first building block</p></li>
<li><p>buildingblock2_smiles - The structure, in SMILES, of the second building block</p></li>
<li><p>buildingblock3_smiles - The structure, in SMILES, of the third building block</p></li>
<li><p>molecule_smiles - The structure of the fully assembled molecule, in SMILES. This includes the three building blocks and the triazine core. Note we use a [Dy] as the stand-in for the DNA linker.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Overview of data types and basic information</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Column Information:&quot;</span><span class="p">)</span>
<span class="n">columns_info</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;DESCRIBE train_sample&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">columns_info</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Information:
             column_name column_type null   key default extra
0                     id      BIGINT  YES  None    None  None
1  buildingblock1_smiles     VARCHAR  YES  None    None  None
2  buildingblock2_smiles     VARCHAR  YES  None    None  None
3  buildingblock3_smiles     VARCHAR  YES  None    None  None
4        molecule_smiles     VARCHAR  YES  None    None  None
5           protein_name     VARCHAR  YES  None    None  None
6                  binds      BIGINT  YES  None    None  None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Summary statistics for numerical variables in the sample</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Summary Statistics:&quot;</span><span class="p">)</span>
<span class="n">summary_stats</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM train_sample&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">summary_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Summary Statistics:
                 id          binds
count  1.000000e+05  100000.000000
mean   1.473787e+08       0.005160
std    8.520179e+07       0.071648
min    1.036000e+03       0.000000
25%    7.410697e+07       0.000000
50%    1.467589e+08       0.000000
75%    2.211598e+08       0.000000
max    2.952442e+08       1.000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Missing Values Analysis in Sample:&quot;</span><span class="p">)</span>
<span class="n">missing_values_sample</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        column_name,</span>
<span class="s2">        COUNT(*) AS total_rows,</span>
<span class="s2">        SUM(CASE WHEN column_value IS NULL THEN 1 ELSE 0 END) AS missing_count,</span>
<span class="s2">        SUM(CASE WHEN column_value IS NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS missing_percentage</span>
<span class="s2">    FROM</span>
<span class="s2">        train_sample,</span>
<span class="s2">        LATERAL unnest(ARRAY[buildingblock1_smiles, buildingblock2_smiles]) AS column_value(column_name)</span>
<span class="s2">    GROUP BY column_name</span>
<span class="s2">    ORDER BY missing_percentage DESC;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_values_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Missing Values Analysis in Sample:
                                           column_name  total_rows  \
0                  O=C(O)CNC(=O)OCC1c2ccccc2-c2ccccc21         405   
1                                       N#CC1=C(N)CCC1          70   
2    O=C(N[C@H](Cc1csc2ccccc12)C(=O)O)OCC1c2ccccc2-...         352   
3    O=C(O)C[C@@H](Cc1ccccc1Cl)NC(=O)OCC1c2ccccc2-c...         378   
4                                      COc1cccc(F)c1CN         140   
..                                                 ...         ...   
959                                 Cl.NCC1OCCc2ccsc21          73   
960                                   Cl.NCc1cnc(Cl)s1          53   
961                             Nc1cc(-c2ccccc2)[nH]n1          66   
962                                  Cl.NCC1CC12CCOCC2          77   
963                         CC1(C)NC(=O)N(CCCN)C1=O.Cl          52   

     missing_count  missing_percentage  
0              0.0                 0.0  
1              0.0                 0.0  
2              0.0                 0.0  
3              0.0                 0.0  
4              0.0                 0.0  
..             ...                 ...  
959            0.0                 0.0  
960            0.0                 0.0  
961            0.0                 0.0  
962            0.0                 0.0  
963            0.0                 0.0  

[964 rows x 4 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binds_distribution_sample</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT binds, COUNT(*) AS count FROM train_sample GROUP BY binds&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Target Variable Distribution in Sample:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">binds_distribution_sample</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">binds_distribution_sample</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;binds&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Target Variable &#39;binds&#39; (Sample)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Binds&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Target Variable Distribution in Sample:
   binds  count
0      0  99484
1      1    516
</pre></div>
</div>
<img alt="_images/1b1ec9cc3ce9112817590b974f14b8afd7eec5a3e119a3e06730a4d0e8ffcb91.png" src="_images/1b1ec9cc3ce9112817590b974f14b8afd7eec5a3e119a3e06730a4d0e8ffcb91.png" />
</div>
</div>
<p>The distribution is heavily skewed towards the value 0, indicating a significant class imbalance. This means that the majority of samples belong to the class 0, while the class 1 is underrepresented. The class imbalance may pose challenges for modeling, as the model might be biased towards the dominant class. To address this issue, techniques like oversampling, undersampling, or class weighting can be employed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM train_sample&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">df</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Protein Targets&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Protein Target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08fa1c469273557002a298f02fae604fb18b4fc95112673a5bfb6dccc22357d5.png" src="_images/08fa1c469273557002a298f02fae604fb18b4fc95112673a5bfb6dccc22357d5.png" />
</div>
</div>
<ul class="simple">
<li><p>BRD4 and HSA: These two protein targets have approximately the same number of occurrences, with counts around 35,000.</p></li>
<li><p>SEH: This protein target has a slightly lower count compared to BRD4 and HSA, falling somewhere between 30,000 and 35,000.</p></li>
</ul>
<p>Overall, the graph indicates a relatively balanced distribution among the three protein targets, with no significant dominance of any particular protein. This suggests that the dataset contains a diverse representation of these targets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;num_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;num_atoms&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Molecule Complexity (Number of Atoms)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Atoms&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/57bee587307442b9a8bf83ea6ead3a1612c942003d204534f7a4ae3821f278ca.png" src="_images/57bee587307442b9a8bf83ea6ead3a1612c942003d204534f7a4ae3821f278ca.png" />
</div>
</div>
<ul class="simple">
<li><p>Distribution shape: The distribution is approximately bell-shaped, suggesting that the majority of molecules have a similar number of atoms, with fewer molecules having significantly fewer or more atoms.</p></li>
<li><p>Peak: The peak of the distribution is located around 40-45 atoms, indicating that this is the most common range of atom numbers among the molecules in the dataset.</p></li>
<li><p>Skewness: The distribution is slightly skewed to the right, with a longer tail extending towards higher numbers of atoms. This indicates that there are some molecules with a larger number of atoms compared to the majority.</p></li>
<li><p>Range: The range of atom numbers is approximately from 25 to 65, suggesting that the molecules in the dataset vary in size from relatively small to moderately large.</p></li>
</ul>
<p>Overall, the histogram provides valuable insights into the complexity of the molecules in the dataset. The majority of molecules have a moderate number of atoms, with a smaller proportion having fewer or more atoms. The slight rightward skew indicates the presence of some larger molecules.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;binds&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;num_atoms&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Molecule Complexity vs Binding&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Binds (0: No, 1: Yes)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Atoms&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/633c637f6cc1a3662cfb4d57458155ebd4c26852b996b85772da6681d06a251d.png" src="_images/633c637f6cc1a3662cfb4d57458155ebd4c26852b996b85772da6681d06a251d.png" />
</div>
</div>
<ul class="simple">
<li><p>Median: The median number of atoms for molecules that bind is slightly higher than the median for non-binding molecules. This suggests that, on average, molecules that bind tend to have a slightly larger number of atoms.</p></li>
<li><p>Interquartile range (IQR): The IQR, which represents the spread of the middle 50% of the data, appears to be similar for both groups. This indicates that the variability in the number of atoms within each binding group is comparable.</p></li>
<li><p>Outliers: There are a few outliers present in both groups, represented by the individual dots outside the whiskers. These outliers suggest that there are some molecules with significantly fewer or more atoms compared to the majority within their respective binding groups.</p></li>
</ul>
<p>Overall, the box plot suggests a slight difference in the distribution of molecule complexity between binding and non-binding molecules. While the median number of atoms is slightly higher for binding molecules, the overall variability within each group is similar. The presence of outliers indicates that there are some exceptions to this general trend.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;mol_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Descriptors</span><span class="o">.</span><span class="n">ExactMolWt</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mol_weight&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Molecular Weights&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Molecular Weight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1a7785302da3eba738a4f13c87b8e8f9809f1102a026d407203e3c6ed7b01f65.png" src="_images/1a7785302da3eba738a4f13c87b8e8f9809f1102a026d407203e3c6ed7b01f65.png" />
</div>
</div>
<ul class="simple">
<li><p>Distribution shape: The distribution is approximately bell-shaped, suggesting that the majority of molecules have a similar molecular weight, with fewer molecules having significantly lower or higher molecular weights.</p></li>
<li><p>Peak: The peak of the distribution is located around 750-800, indicating that this is the most common range of molecular weights among the molecules in the dataset.</p></li>
<li><p>Skewness: The distribution is slightly skewed to the right, with a longer tail extending towards higher molecular weights. This indicates that there are some molecules with a larger molecular weight compared to the majority.</p></li>
<li><p>Range: The range of molecular weights appears to be approximately from 500 to 1300, suggesting that the molecules in the dataset vary in size from relatively small to moderately large.</p></li>
</ul>
<p>Overall, the histogram provides valuable insights into the molecular weights of the molecules in the dataset. The majority of molecules have a moderate molecular weight, with a smaller proportion having lower or higher molecular weights. The slight rightward skew indicates the presence of some larger molecules.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;bb</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;buildingblock</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">())</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;bb</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_atoms&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of Building Block </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> Complexity (Number of Atoms)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Atoms&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c09f315a60b42b8d896946029a6dc7cac26f87bedd28f90323781e0b05b22fdf.png" src="_images/c09f315a60b42b8d896946029a6dc7cac26f87bedd28f90323781e0b05b22fdf.png" />
<img alt="_images/ce977607b1b4eab1401a92bb65b4fabbf2484b3e68c1848f33c3002b6764fd5f.png" src="_images/ce977607b1b4eab1401a92bb65b4fabbf2484b3e68c1848f33c3002b6764fd5f.png" />
<img alt="_images/5f73b232979cdf32cd182d0807cfcde41374fad901dd71bb47261d50f9fc97cf.png" src="_images/5f73b232979cdf32cd182d0807cfcde41374fad901dd71bb47261d50f9fc97cf.png" />
</div>
</div>
<ul class="simple">
<li><p>Multimodal distributions: All three distributions exhibit multiple peaks and valleys, suggesting that there are several distinct groups of building blocks with different numbers of atoms.
Peak locations: The most prominent peaks for building block 1 are around 27.5, 30, and 32.5 atoms; for building block 2, they are around 0-2.5, 7.5-10, and 12.5-15 atoms; and for building block 3, they are around 0-2.5, 10, and 12.5 atoms.</p></li>
<li><p>Skewness: All three distributions are skewed to the right, with longer tails extending towards higher numbers of atoms. This indicates that there are some building blocks with a larger number of atoms compared to the majority.</p></li>
<li><p>Range: The range of atom numbers is similar for all three building blocks, approximately from 0 to 20.</p></li>
</ul>
<p>Overall: The analysis suggests that while all three building blocks exhibit similar patterns of complexity, there are notable differences in the specific ranges of atom numbers that are most common. Building block 1 has a higher tendency to have larger numbers of atoms, while building block 2 and 3 have a more concentrated distribution around lower atom numbers. The rightward skew in all three distributions indicates the presence of some larger building blocks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binding_rate</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;protein_name&#39;</span><span class="p">)[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;binds&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">binding_rate</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Binding Rate by Protein Target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Protein Target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Binding Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1893c8c6ee89baf7a062635c5f41ac9539c618664907cb83a7134e1b4def85f0.png" src="_images/1893c8c6ee89baf7a062635c5f41ac9539c618664907cb83a7134e1b4def85f0.png" />
</div>
</div>
<ul class="simple">
<li><p>Highest binding rate: SEH has the highest binding rate among the three targets.</p></li>
<li><p>Lowest binding rate: BRD4 has the lowest binding rate.</p></li>
<li><p>Intermediate binding rate: HSA has an intermediate binding rate, falling between BRD4 and SEH.</p></li>
</ul>
<p>Overall, the plot indicates that the binding rates for the three protein targets vary significantly. SEH exhibits the highest binding rate, while BRD4 exhibits the lowest. HSA’s binding rate is positioned between the two extremes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smiles_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT </span>
<span class="s2">    LENGTH(buildingblock1_smiles) AS buildingblock1_length,</span>
<span class="s2">    LENGTH(buildingblock2_smiles) AS buildingblock2_length,</span>
<span class="s2">    LENGTH(buildingblock3_smiles) AS buildingblock3_length,</span>
<span class="s2">    LENGTH(molecule_smiles) AS molecule_length</span>
<span class="s2">FROM train_sample</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">smiles_lengths</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">smiles_query</span><span class="p">)</span><span class="o">.</span><span class="n">df</span><span class="p">()</span>

<span class="c1"># Plotting lengths of SMILES strings</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">smiles_lengths</span><span class="p">[</span><span class="s1">&#39;buildingblock1_length&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Building Block 1 Length&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">smiles_lengths</span><span class="p">[</span><span class="s1">&#39;buildingblock2_length&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Building Block 2 Length&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">smiles_lengths</span><span class="p">[</span><span class="s1">&#39;buildingblock3_length&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Building Block 3 Length&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">smiles_lengths</span><span class="p">[</span><span class="s1">&#39;molecule_length&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Molecule Length&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of SMILES String Lengths&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Length of SMILES Strings&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a6937d02ebf5b9aab5a5a2c518ce966731294c57f0c1d98011c40d2f940abaf9.png" src="_images/a6937d02ebf5b9aab5a5a2c518ce966731294c57f0c1d98011c40d2f940abaf9.png" />
</div>
</div>
<p><strong>Building Block 1:</strong></p>
<ul class="simple">
<li><p>The distribution is unimodal, with a single peak around 60-70.</p></li>
<li><p>The majority of SMILES strings for Building Block 1 have a length between 50 and 80.</p></li>
<li><p>There are fewer strings with lengths below 50 or above 80.</p></li>
</ul>
<p><strong>Building Block 2:</strong></p>
<ul class="simple">
<li><p>The distribution is also unimodal, with a peak around 20-30.</p></li>
<li><p>The majority of SMILES strings for Building Block 2 have a length between 10 and 40.</p></li>
<li><p>There are fewer strings with lengths below 10 or above 40.</p></li>
</ul>
<p><strong>Building Block 3:</strong></p>
<ul class="simple">
<li><p>The distribution is unimodal, with a peak around 20-30.</p></li>
<li><p>The majority of SMILES strings for Building Block 3 have a length between 10 and 40.</p></li>
<li><p>There are fewer strings with lengths below 10 or above 40.</p></li>
</ul>
<p><strong>Molecule:</strong></p>
<ul class="simple">
<li><p>The distribution is unimodal, with a peak around 80-90.</p></li>
<li><p>The majority of SMILES strings for the entire molecule have a length between 60 and 110.</p></li>
<li><p>There are fewer strings with lengths below 60 or above 110.</p></li>
</ul>
<p><strong>Overall analysis:</strong></p>
<p>The SMILES strings for Building Block 1 tend to be longer than those for Building Block 2 and 3.
The SMILES strings for Building Block 2 and 3 have similar length distributions, with a majority of strings falling within the 10-40 range.
The length distribution of the entire molecule is influenced by the combined lengths of its individual building blocks. The peak for the molecule’s distribution is located at a higher value compared to the individual building blocks, reflecting the cumulative effect of their lengths.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">smiles_lengths</span><span class="p">[[</span><span class="s1">&#39;buildingblock1_length&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock2_length&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock3_length&#39;</span><span class="p">,</span> <span class="s1">&#39;molecule_length&#39;</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Box Plot of SMILES String Lengths&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Length&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;SMILES Variables&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c48f09497090c1a821b64aece85ef4436a763830dae78a146989e022dc36ed14.png" src="_images/c48f09497090c1a821b64aece85ef4436a763830dae78a146989e022dc36ed14.png" />
</div>
</div>
</section>
<section id="molecules">
<h2>Molecules<a class="headerlink" href="#molecules" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">visualize_and_save_molecules</span><span class="p">(</span><span class="n">smiles_list</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span> <span class="k">for</span> <span class="n">smiles</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">]</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="n">legends</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
    <span class="n">pil_img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">visualize_and_display_molecules</span><span class="p">(</span><span class="n">smiles_list</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span> <span class="k">for</span> <span class="n">smiles</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">]</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="n">legends</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">IPImage</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

<span class="c1"># 1. Original example molecules (first 6)</span>
<span class="n">example_mols</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">example_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Molecule </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">visualize_and_display_molecules</span><span class="p">(</span><span class="n">example_mols</span><span class="p">,</span> <span class="n">example_labels</span><span class="p">,</span> <span class="s2">&quot;Example Molecules (First 6)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/29f81fbca98297524e29f4a5af273bfeeaf2626007bc7c36871dedbf0d5b94b6.png" src="_images/29f81fbca98297524e29f4a5af273bfeeaf2626007bc7c36871dedbf0d5b94b6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Example Molecules (First 6)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Size and complexity:</strong> The molecules vary in size and complexity. Some molecules have relatively simple structures with fewer atoms and bonds, while others have more complex structures with numerous atoms and bonds.</p></li>
<li><p><strong>Rings:</strong> Several of the molecules contain rings of atoms, which are common structural features in organic compounds.</p></li>
<li><p><strong>Functional groups:</strong> Different colored circles and symbols may represent various functional groups, such as hydroxyl groups (-OH), carbonyl groups (C=O), and amine groups (-NH2). These functional groups often determine the chemical properties and reactivity of a molecule.</p></li>
<li><p><strong>Stereochemistry:</strong> The spatial arrangement of atoms in a molecule can be important for its biological activity and properties. The image does not explicitly show stereochemistry, but it is possible that certain molecules have chiral centers, which can lead to different stereoisomers.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binding_mols</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">binding_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Binding Molecule </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">visualize_and_display_molecules</span><span class="p">(</span><span class="n">binding_mols</span><span class="p">,</span> <span class="n">binding_labels</span><span class="p">,</span> <span class="s2">&quot;Binding Molecules (First 6)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1b39465457c1e2b3312b0821f41f67742082bcdf16acd26e0f30b184b043c54e.png" src="_images/1b39465457c1e2b3312b0821f41f67742082bcdf16acd26e0f30b184b043c54e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Binding Molecules (First 6)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>**Size and complexity:**The molecules vary in size and complexity. Some molecules have relatively simple structures with fewer atoms and bonds, while others have more complex structures with numerous atoms and bonds.</p></li>
<li><p><strong>Rings:</strong> Several of the molecules contain rings of atoms, which are common structural features in organic compounds.</p></li>
<li><p><strong>Functional groups:</strong> Different colored circles and symbols may represent various functional groups, such as hydroxyl groups (-OH), carbonyl groups (C=O), and amine groups (-NH2). These functional groups often determine the chemical properties and reactivity of a molecule.</p></li>
<li><p><strong>Stereochemistry:</strong> The spatial arrangement of atoms in a molecule can be important for its biological activity and properties. The image does not explicitly show stereochemistry, but it is possible that certain molecules have chiral centers, which can lead to different stereoisomers.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">non_binding_mols</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">non_binding_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Non-binding Molecule </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">visualize_and_display_molecules</span><span class="p">(</span><span class="n">non_binding_mols</span><span class="p">,</span> <span class="n">non_binding_labels</span><span class="p">,</span> <span class="s2">&quot;Non-binding Molecules (First 6)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b8eae8da1a5c88b3af65691c8bc514df4ddca3c2544fa0b8916ef1a5a2fd4b99.png" src="_images/b8eae8da1a5c88b3af65691c8bc514df4ddca3c2544fa0b8916ef1a5a2fd4b99.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Non-binding Molecules (First 6)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Size and complexity: The molecules vary in size and complexity. Some molecules have relatively simple structures with fewer atoms and bonds, while others have more complex structures with numerous atoms and bonds.</p></li>
<li><p>Rings: Several of the molecules contain rings of atoms, which are common structural features in organic compounds.</p></li>
<li><p>Functional groups: Different colored circles and symbols may represent various functional groups, such as hydroxyl groups (-OH), carbonyl groups (C=O), and amine groups (-NH2). These functional groups often determine the chemical properties and reactivity of a molecule.</p></li>
<li><p>Stereochemistry: The spatial arrangement of atoms in a molecule can be important for its biological activity and properties. The image does not explicitly show stereochemistry, but it is possible that certain molecules have chiral centers, which can lead to different stereoisomers.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;mol_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Descriptors</span><span class="o">.</span><span class="n">ExactMolWt</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">high_weight_mols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;mol_weight&#39;</span><span class="p">)[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">high_weight_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;High MW Molecule </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">visualize_and_display_molecules</span><span class="p">(</span><span class="n">high_weight_mols</span><span class="p">,</span> <span class="n">high_weight_labels</span><span class="p">,</span> <span class="s2">&quot;High Molecular Weight Molecules (Top 6)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4a9687d8a4041dfc025afcd7af2fda718b30467aed5ab881b9c9b553f4ec98a3.png" src="_images/4a9687d8a4041dfc025afcd7af2fda718b30467aed5ab881b9c9b553f4ec98a3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>High Molecular Weight Molecules (Top 6)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Size and complexity:</strong> The molecules appear to be relatively large and complex, as suggested by their labeling as “High MW” (high molecular weight). They contain numerous atoms and bonds, with intricate structures involving multiple rings and functional groups.</p></li>
<li><p><strong>Rings:</strong> Several of the molecules contain rings of atoms, including aromatic rings (represented by hexagons) and non-aromatic rings.</p></li>
<li><p><strong>Functional groups:</strong> The molecules display a variety of functional groups, such as hydroxyl groups (-OH), carbonyl groups (C=O), amine groups (-NH2), and halogen atoms (Cl, Br). These functional groups can influence the chemical properties and reactivity of the molecules.</p></li>
<li><p><strong>Stereochemistry:</strong> While the image does not explicitly show stereochemistry, it is possible that some of these molecules contain chiral centers, which can lead to different stereoisomers.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">low_weight_mols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;mol_weight&#39;</span><span class="p">)[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">low_weight_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Low MW Molecule </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">visualize_and_display_molecules</span><span class="p">(</span><span class="n">low_weight_mols</span><span class="p">,</span> <span class="n">low_weight_labels</span><span class="p">,</span> <span class="s2">&quot;Low Molecular Weight Molecules (Bottom 6)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/486b5f47ac91ac1445eb8a76837676bb325a5d7fd3b0b2ae72a33c56baa0b91c.png" src="_images/486b5f47ac91ac1445eb8a76837676bb325a5d7fd3b0b2ae72a33c56baa0b91c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Low Molecular Weight Molecules (Bottom 6)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Size and complexity:</strong> The molecules appear to be relatively small and less complex. They have fewer atoms and bonds, with simpler structural arrangements.</p></li>
<li><p><strong>Rings:</strong> Some of the molecules contain rings of atoms, including aromatic rings (represented by hexagons).</p></li>
<li><p><strong>Functional groups:</strong> The molecules display a variety of functional groups, such as hydroxyl groups (-OH), carbonyl groups (C=O), amine groups (-NH2), and halogen atoms (Cl, Br). These functional groups can influence the chemical properties and reactivity of the molecules.</p></li>
<li><p><strong>Stereochemistry:</strong> While the image does not explicitly show stereochemistry, it is possible that some of these molecules contain chiral centers, which can lead to different stereoisomers.</p></li>
</ul>
<section id="more-in-depth-visualization-for-first-molecule">
<h3>More in depth visualization for first molecule<a class="headerlink" href="#more-in-depth-visualization-for-first-molecule" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_path</span> <span class="o">=</span> <span class="s1">&#39;train.parquet/train.parquet&#39;</span>
<span class="n">test_path</span> <span class="o">=</span> <span class="s1">&#39;test.parquet/test.parquet&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;(SELECT *</span>
<span class="s2">                        FROM parquet_scan(&#39;</span><span class="si">{</span><span class="n">train_path</span><span class="si">}</span><span class="s2">&#39;)</span>
<span class="s2">                        WHERE binds = 0</span>
<span class="s2">                        ORDER BY random()</span>
<span class="s2">                        LIMIT 90000)</span>
<span class="s2">                        UNION ALL</span>
<span class="s2">                        (SELECT *</span>
<span class="s2">                        FROM parquet_scan(&#39;</span><span class="si">{</span><span class="n">train_path</span><span class="si">}</span><span class="s2">&#39;)</span>
<span class="s2">                        WHERE binds = 1</span>
<span class="s2">                        ORDER BY random()</span>
<span class="s2">                        LIMIT 90000)&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">df</span><span class="p">()</span>

<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "21b83afbff31457b8117466d8d2e5d11", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">first_molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">first_smiles</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">first_molecule</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8b0a4f1de287b8410d478d2424610d8eb0bc31aa2228a7e3b680caea474b626e.png" src="_images/8b0a4f1de287b8410d478d2424610d8eb0bc31aa2228a7e3b680caea474b626e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">first_molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">first_smiles</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">first_molecule</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ecc9ae32cb10478311ed78efc3b03ac7c40cc30359a651fe9aa2d3027f101cf2.png" src="_images/ecc9ae32cb10478311ed78efc3b03ac7c40cc30359a651fe9aa2d3027f101cf2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">first_molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">first_smiles</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">first_molecule</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/92dfe23f0f69c45d4155c24a3cbbf352d826d59e91fb92c18279098df6138464.png" src="_images/92dfe23f0f69c45d4155c24a3cbbf352d826d59e91fb92c18279098df6138464.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">first_molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">first_smiles</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">first_molecule</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9638021b6dfca89d7d85717ec0bb2981f2978a7bd44006d612eff4a04f6589f.png" src="_images/b9638021b6dfca89d7d85717ec0bb2981f2978a7bd44006d612eff4a04f6589f.png" />
</div>
</div>
</section>
</section>
<section id="d-first-molecule">
<h2>3D First Molecule<a class="headerlink" href="#d-first-molecule" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">py3Dmol</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">AllChem</span>

<span class="n">first_molecule_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">first_molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">first_molecule_smiles</span><span class="p">)</span>

<span class="n">first_molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span><span class="n">first_molecule</span><span class="p">)</span>
<span class="n">AllChem</span><span class="o">.</span><span class="n">EmbedMolecule</span><span class="p">(</span><span class="n">first_molecule</span><span class="p">)</span>

<span class="c1"># Visualize the molecule in 3D using Py3Dmol</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">py3Dmol</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">pdb_block_molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToPDBBlock</span><span class="p">(</span><span class="n">first_molecule</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">pdb_block_molecule</span><span class="p">,</span> <span class="s1">&#39;pdb&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{}})</span>
<span class="n">view</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">view</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[14:30:52] UFFTYPER: Unrecognized charge state for atom: 35
[14:30:52] UFFTYPER: Unrecognized atom type: Dy5+3 (35)
</pre></div>
</div>
<div class="output text_html"><div id="3dmolviewer_17271198522279897"  style="position: relative; width: 800px; height: 600px;">
        <p id="3dmolwarning_17271198522279897" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17271198522279897 = null;
var warn = document.getElementById("3dmolwarning_17271198522279897");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17271198522279897 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17271198522279897"),{backgroundColor:"white"});
viewer_17271198522279897.zoomTo();
	viewer_17271198522279897.addModel("HETATM    1  C1  UNL     1      -0.621   7.967   0.585  1.00  0.00           C  \nHETATM    2  C2  UNL     1      -1.195   6.598   0.552  1.00  0.00           C  \nHETATM    3  C3  UNL     1      -0.347   5.536   0.351  1.00  0.00           C  \nHETATM    4  C4  UNL     1      -0.822   4.236   0.311  1.00  0.00           C  \nHETATM    5  N1  UNL     1      -0.017   3.100   0.109  1.00  0.00           N  \nHETATM    6  C5  UNL     1      -0.368   1.732   0.046  1.00  0.00           C  \nHETATM    7  N2  UNL     1      -1.580   1.222   0.169  1.00  0.00           N  \nHETATM    8  C6  UNL     1      -1.942  -0.060   0.114  1.00  0.00           C  \nHETATM    9  N3  UNL     1      -3.305  -0.414   0.271  1.00  0.00           N  \nHETATM   10  C7  UNL     1      -3.839  -1.722   0.238  1.00  0.00           C  \nHETATM   11  C8  UNL     1      -3.153  -2.889   0.059  1.00  0.00           C  \nHETATM   12  C9  UNL     1      -3.717  -4.141   0.034  1.00  0.00           C  \nHETATM   13  C10 UNL     1      -5.100  -4.277   0.201  1.00  0.00           C  \nHETATM   14  O1  UNL     1      -5.570  -5.573   0.160  1.00  0.00           O  \nHETATM   15  C11 UNL     1      -6.920  -5.938   0.305  1.00  0.00           C  \nHETATM   16  F1  UNL     1      -7.255  -6.593  -0.885  1.00  0.00           F  \nHETATM   17  F2  UNL     1      -7.095  -6.837   1.359  1.00  0.00           F  \nHETATM   18  C12 UNL     1      -5.822  -3.122   0.384  1.00  0.00           C  \nHETATM   19  C13 UNL     1      -5.204  -1.895   0.400  1.00  0.00           C  \nHETATM   20  N4  UNL     1      -0.896  -0.856  -0.094  1.00  0.00           N  \nHETATM   21  C14 UNL     1       0.378  -0.483  -0.237  1.00  0.00           C  \nHETATM   22  N5  UNL     1       1.401  -1.436  -0.459  1.00  0.00           N  \nHETATM   23  C15 UNL     1       2.773  -0.916  -0.584  1.00  0.00           C  \nHETATM   24  C16 UNL     1       3.632  -2.113  -0.869  1.00  0.00           C  \nHETATM   25  C17 UNL     1       5.055  -1.872  -1.036  1.00  0.00           C  \nHETATM   26  C18 UNL     1       6.027  -1.917  -0.033  1.00  0.00           C  \nHETATM   27  C19 UNL     1       7.356  -1.682  -0.213  1.00  0.00           C  \nHETATM   28  C20 UNL     1       7.814  -1.374  -1.456  1.00  0.00           C  \nHETATM   29  F3  UNL     1       9.134  -1.144  -1.617  1.00  0.00           F  \nHETATM   30  C21 UNL     1       6.905  -1.313  -2.495  1.00  0.00           C  \nHETATM   31  F4  UNL     1       7.415  -1.002  -3.714  1.00  0.00           F  \nHETATM   32  C22 UNL     1       5.547  -1.555  -2.301  1.00  0.00           C  \nHETATM   33  C23 UNL     1       3.244  -0.339   0.702  1.00  0.00           C  \nHETATM   34  O2  UNL     1       4.377   0.227   0.878  1.00  0.00           O  \nHETATM   35  N6  UNL     1       2.483  -0.348   1.901  1.00  0.00           N  \nHETATM   36 DY1  UNL     1       3.316   0.497   3.542  1.00  0.00          DY  \nHETATM   37  N7  UNL     1       0.591   0.819  -0.160  1.00  0.00           N  \nHETATM   38  C24 UNL     1      -2.184   4.151   0.489  1.00  0.00           C  \nHETATM   39  N8  UNL     1      -3.020   5.190   0.686  1.00  0.00           N  \nHETATM   40  C25 UNL     1      -2.554   6.464   0.726  1.00  0.00           C  \nHETATM   41 BR1  UNL     1      -3.712   7.950   1.004  1.00  0.00          BR  \nHETATM   42  H1  UNL     1       0.356   7.962   0.084  1.00  0.00           H  \nHETATM   43  H2  UNL     1      -1.285   8.579  -0.093  1.00  0.00           H  \nHETATM   44  H3  UNL     1      -0.617   8.412   1.604  1.00  0.00           H  \nHETATM   45  H4  UNL     1       0.721   5.705   0.220  1.00  0.00           H  \nHETATM   46  H5  UNL     1       1.008   3.350  -0.010  1.00  0.00           H  \nHETATM   47  H6  UNL     1      -3.982   0.371   0.426  1.00  0.00           H  \nHETATM   48  H7  UNL     1      -2.090  -2.846  -0.074  1.00  0.00           H  \nHETATM   49  H8  UNL     1      -3.087  -5.020  -0.116  1.00  0.00           H  \nHETATM   50  H9  UNL     1      -7.588  -5.093   0.462  1.00  0.00           H  \nHETATM   51  H10 UNL     1      -6.869  -3.215   0.511  1.00  0.00           H  \nHETATM   52  H11 UNL     1      -5.858  -1.033   0.552  1.00  0.00           H  \nHETATM   53  H12 UNL     1       1.148  -2.447  -0.524  1.00  0.00           H  \nHETATM   54  H13 UNL     1       2.754  -0.177  -1.382  1.00  0.00           H  \nHETATM   55  H14 UNL     1       3.267  -2.589  -1.825  1.00  0.00           H  \nHETATM   56  H15 UNL     1       3.464  -2.888  -0.096  1.00  0.00           H  \nHETATM   57  H16 UNL     1       5.690  -2.163   0.960  1.00  0.00           H  \nHETATM   58  H17 UNL     1       8.033  -1.745   0.649  1.00  0.00           H  \nHETATM   59  H18 UNL     1       4.914  -1.483  -3.174  1.00  0.00           H  \nHETATM   60  H19 UNL     1       1.538  -0.780   1.913  1.00  0.00           H  \nHETATM   61  H20 UNL     1      -2.731   3.224   0.488  1.00  0.00           H  \nCONECT    1    2   42   43   44\nCONECT    2    3    3   40\nCONECT    3    4   45\nCONECT    4    5   38   38\nCONECT    5    6   46\nCONECT    6    7    7   37\nCONECT    7    8\nCONECT    8    9   20   20\nCONECT    9   10   47\nCONECT   10   11   11   19\nCONECT   11   12   48\nCONECT   12   13   13   49\nCONECT   13   14   18\nCONECT   14   15\nCONECT   15   16   17   50\nCONECT   18   19   19   51\nCONECT   19   52\nCONECT   20   21\nCONECT   21   22   37   37\nCONECT   22   23   53\nCONECT   23   24   33   54\nCONECT   24   25   55   56\nCONECT   25   26   26   32\nCONECT   26   27   57\nCONECT   27   28   28   58\nCONECT   28   29   30\nCONECT   30   31   32   32\nCONECT   32   59\nCONECT   33   34   34   35\nCONECT   35   36   60\nCONECT   38   39   61\nCONECT   39   40   40\nCONECT   40   41\nEND\n","pdb");
	viewer_17271198522279897.setStyle({"stick": {}});
	viewer_17271198522279897.zoomTo();
viewer_17271198522279897.render();
});
</script></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelo">
<h1>Modelo<a class="headerlink" href="#modelo" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">average_precision_score</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">Descriptors</span>
<span class="kn">import</span> <span class="nn">duckdb</span>
<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">StratifiedKFold</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="kn">import</span> <span class="n">LGBMClassifier</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">joblib</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_parquet_path</span> <span class="o">=</span> <span class="s1">&#39;train.parquet/train.parquet&#39;</span>

<span class="n">test_parquet_path</span> <span class="o">=</span> <span class="s1">&#39;test.parquet/test.parquet&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="c1"># Sample 30,000 rows each for binds = 0 and binds = 1 from train.parquet</span>
<span class="n">query_train</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    (SELECT *</span>
<span class="s2">    FROM parquet_scan(&#39;</span><span class="si">{</span><span class="n">train_parquet_path</span><span class="si">}</span><span class="s2">&#39;)</span>
<span class="s2">    WHERE binds = 0</span>
<span class="s2">    ORDER BY random()</span>
<span class="s2">    LIMIT 30000)</span>
<span class="s2">    UNION ALL</span>
<span class="s2">    (SELECT *</span>
<span class="s2">    FROM parquet_scan(&#39;</span><span class="si">{</span><span class="n">train_parquet_path</span><span class="si">}</span><span class="s2">&#39;)</span>
<span class="s2">    WHERE binds = 1</span>
<span class="s2">    ORDER BY random()</span>
<span class="s2">    LIMIT 30000)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Load data into DataFrame</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">from_query</span><span class="p">(</span><span class="n">query_train</span><span class="p">)</span><span class="o">.</span><span class="n">df</span><span class="p">()</span>

<span class="c1"># Load test data without sampling</span>
<span class="n">query_test</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT *</span>
<span class="s2">    FROM parquet_scan(&#39;</span><span class="si">{</span><span class="n">test_parquet_path</span><span class="si">}</span><span class="s2">&#39;)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">test_df</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">from_query</span><span class="p">(</span><span class="n">query_test</span><span class="p">)</span><span class="o">.</span><span class="n">df</span><span class="p">()</span>

<span class="c1"># Close DuckDB connection</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2040c142b81b4404991ba13617944761", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_descriptors</span><span class="p">(</span><span class="n">smiles</span><span class="p">):</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="n">num_atoms</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span>
    <span class="n">mol_weight</span> <span class="o">=</span> <span class="n">Descriptors</span><span class="o">.</span><span class="n">MolWt</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">num_atoms</span><span class="p">,</span> <span class="n">mol_weight</span>

<span class="c1"># Calculate descriptors for train and test data</span>
<span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;num_atoms&#39;</span><span class="p">],</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;mol_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calculate_descriptors</span><span class="p">))</span>
<span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;num_atoms&#39;</span><span class="p">],</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;mol_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calculate_descriptors</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;num_atoms&#39;</span><span class="p">,</span> <span class="s1">&#39;mol_weight&#39;</span><span class="p">]</span>
<span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;binds&#39;</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s1">&#39;auc&#39;</span><span class="p">:</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
    <span class="p">}</span>

<span class="c1"># Split data</span>
<span class="n">X_train_np</span><span class="p">,</span> <span class="n">X_test_np</span><span class="p">,</span> <span class="n">y_train_np</span><span class="p">,</span> <span class="n">y_test_np</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Print data sizes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training data size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train_np</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test data size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test_np</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Apply SMOTE to balance the dataset</span>
<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_train_resampled</span><span class="p">,</span> <span class="n">y_train_resampled</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train_np</span><span class="p">,</span> <span class="n">y_train_np</span><span class="p">)</span>

<span class="c1"># Convert resampled data to tensors</span>
<span class="n">X_train_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_train_resampled</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y_train_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">y_train_resampled</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">X_test_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test_np</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training data size: 3000
Test data size: 57000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MLP model</span>
<span class="k">class</span> <span class="nc">ImprovedMLPModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_features</span><span class="p">,</span> <span class="n">hidden_dim1</span><span class="p">,</span> <span class="n">hidden_dim2</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ImprovedMLPModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">hidden_dim1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim1</span><span class="p">,</span> <span class="n">hidden_dim2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim2</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="n">hidden_dim1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="n">hidden_dim2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Initialize improved MLP model</span>
<span class="n">num_features</span> <span class="o">=</span> <span class="n">X_train_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">hidden_dim1</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">hidden_dim2</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Binary classification</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ImprovedMLPModel</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">hidden_dim1</span><span class="p">,</span> <span class="n">hidden_dim2</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>


<span class="n">positive_weight</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">500.0</span><span class="p">])</span> 
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCEWithLogitsLoss</span><span class="p">(</span><span class="n">pos_weight</span><span class="o">=</span><span class="n">positive_weight</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train the MLP model</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<span class="n">mlp_train_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_train_tensor</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">y_train_tensor</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<span class="n">mlp_train_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">mlp_train_start</span>

<span class="c1"># Evaluate MLP model</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">mlp_predict_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_test_tensor</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">output</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="n">y_pred_proba</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">mlp_predict_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">mlp_predict_start</span>

<span class="n">mlp_metrics</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_test_np</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---- Modelos con Pipelines y GridSearch ----</span>

<span class="n">pipelines</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;random_forest&#39;</span><span class="p">:</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;random_forest&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
    <span class="p">]),</span>
    <span class="s1">&#39;xgboost&#39;</span><span class="p">:</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;xgboost&#39;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
    <span class="p">]),</span>
    <span class="s1">&#39;lgbm&#39;</span><span class="p">:</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;lgbm&#39;</span><span class="p">,</span> <span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
    <span class="p">])</span>
<span class="p">}</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;random_forest&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;random_forest__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
        <span class="s1">&#39;random_forest__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="s1">&#39;xgboost&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;xgboost__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
        <span class="s1">&#39;xgboost__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="s1">&#39;lgbm&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;lgbm__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
        <span class="s1">&#39;lgbm__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">trained_models</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> 

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">pipelines</span><span class="p">)):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>  
    <span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipelines</span><span class="p">[</span><span class="n">model</span><span class="p">],</span> <span class="n">param_grid</span><span class="p">[</span><span class="n">model</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_np</span><span class="p">,</span> <span class="n">y_train_np</span><span class="p">)</span>  
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>  

    <span class="n">trained_models</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_np</span><span class="p">)</span>
    <span class="n">y_prob</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_np</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>  
    
    <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_np</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test_np</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">)</span>
    <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
    
    <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test_np</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test_np</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test_np</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
        <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span>
        <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span>
        <span class="s1">&#39;F1-score&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
        <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
        <span class="s1">&#39;Best Parameters&#39;</span><span class="p">:</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span>
        <span class="s1">&#39;Elapsed Time&#39;</span><span class="p">:</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="p">})</span>

    <span class="c1"># Matriz de confusión</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confusion Matrix for </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;True Label&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Label&#39;</span><span class="p">)</span>

    <span class="c1"># Curva ROC</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC curve (area = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ROC Curve for </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/3 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 6 candidates, totalling 30 fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 33%|███▎      | 1/3 [00:02&lt;00:04,  2.44s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 4 candidates, totalling 20 fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 67%|██████▋   | 2/3 [00:04&lt;00:01,  1.97s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 4 candidates, totalling 20 fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 3/3 [00:04&lt;00:00,  1.59s/it]
</pre></div>
</div>
<img alt="_images/59e7f06803ad6cedea4201328820c27c3d73d86de78ea2c0cc8e9086e76c06c1.png" src="_images/59e7f06803ad6cedea4201328820c27c3d73d86de78ea2c0cc8e9086e76c06c1.png" />
</div>
</div>
<p><strong>Random Forest:</strong>
Has a relatively high number of true positives and true negatives.
Shows a moderate number of false positives and false negatives.</p>
<p><strong>XGBoost:</strong>
Exhibits a similar pattern to Random Forest, with slightly higher true positives and lower false negatives.</p>
<p><strong>LightGBM:</strong>
Demonstrates the highest number of true positives and the lowest number of false negatives among the three models.</p>
<p><em><strong>From the ROC curves, we can infer:</strong></em></p>
<ul class="simple">
<li><p>XGBoost: Has the highest AUC, suggesting the best overall performance in terms of sensitivity and specificity.</p></li>
<li><p>LightGBM: Shows a slightly lower AUC than XGBoost but still outperforms Random Forest.</p></li>
<li><p>Random Forest: Has the lowest AUC among the three models.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create bar plot for performance metrics</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">metrics</span><span class="p">))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">multiplier</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">width</span> <span class="o">*</span> <span class="n">multiplier</span>
    <span class="n">rects</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">measurement</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">attribute</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">rects</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">multiplier</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Scores&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Model Performance Comparison&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0a5c8e2017b07c8a44c142eb752903a50a2b69d9de3ec51481dcf05f2fd774a1.png" src="_images/0a5c8e2017b07c8a44c142eb752903a50a2b69d9de3ec51481dcf05f2fd774a1.png" />
</div>
</div>
<p>MLP, XGBoost, LightGBM, and Random Forest, across five metrics: accuracy, precision, recall, F1-score, and AUC. Overall, XGBoost and LightGBM demonstrate superior performance, with XGBoost achieving the highest scores in most metrics. Random Forest consistently lags behind the other models. MLP’s performance varies across metrics, with its highest score in recall. While XGBoost and LightGBM show similar overall performance, XGBoost slightly outperforms LightGBM in terms of accuracy, precision, and F1-score.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to our solution for the Deep Learning Exam</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Introduction</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-application-problem">Understanding the Application Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-types">Data Types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source">Data Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explanatory-variables">Explanatory Variables</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-problem">Application Problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach">Approach</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#smiles-simplified-molecular-input-line-entry-system">SMILES (Simplified Molecular Input Line Entry System)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-smiles">What is SMILES?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smiles">SMILES</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#molecules">Molecules</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-in-depth-visualization-for-first-molecule">More in depth visualization for first molecule</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-first-molecule">3D First Molecule</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo">Modelo</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Juan Albis and Shadia Jaafar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>